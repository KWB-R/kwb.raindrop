% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_overflow_events_and_waterbalance.R
\name{add_overflow_events_and_waterbalance}
\alias{add_overflow_events_and_waterbalance}
\title{Add overflow-event metrics and water-balance shares (percent) to simulation results}
\usage{
add_overflow_events_and_waterbalance(
  simulation_results,
  event_separation_hours = 4
)
}
\arguments{
\item{simulation_results}{Named list of scenario results. Each entry is expected
to contain:
\itemize{
\item \code{element$water_balance} with columns \code{variable}, \code{value}
\item \code{connected_area$water_balance} with columns \code{variable}, \code{value}
\item \code{element$rates} with columns \code{time}, \code{variable}, \code{value}
}}

\item{event_separation_hours}{Numeric. Minimum time between two overflow events
(in hours). Defaults to \code{4}.}
}
\value{
A tibble with one row per scenario containing:
\itemize{
\item \code{s_name}
\item \code{n_overflows}
\item \code{median_duration_overflows_hours}
\item \code{sum_overflows}
\item water-balance percentage columns for \verb{element.*_} and \verb{connectedarea.*_}
}
}
\description{
Computes (i) overflow event statistics from the element outflow time series and
(ii) water-balance components as \emph{percent shares} for both \code{element} and
\code{connected_area} per scenario.
}
\details{
Water-balance percentages are computed with sign preserved (\code{value / denom}):
\itemize{
\item \strong{element} denominator: \code{WB_Regen + abs(WB_Oberflaechenablauf_Verschaltungen)}
\item \strong{connected_area} denominator: \code{WB_Regen} (fallback to
\code{abs(WB_Oberflaechenablauf_Verschaltungen)} if \code{WB_Regen} is \code{NA} or \code{0})
}

Overflow events are derived from positive \code{Oberflaechenablauf_Ueberlauf} values
using \code{kwb.event::hsEvents()}. Event separation is controlled via
\code{event_separation_hours} (converted to seconds).
}
\examples{
\dontrun{
out <- add_overflow_events_and_waterbalance(simulation_results)
out <- add_overflow_events_and_waterbalance(simulation_results, event_separation_hours = 6)
}

}
