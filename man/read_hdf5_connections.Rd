% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_hdf5_connections.R
\name{read_hdf5_connections}
\alias{read_hdf5_connections}
\title{Read surface-water connections from an HDF5 results file}
\usage{
read_hdf5_connections(file)
}
\arguments{
\item{file}{An \code{\link[hdf5r:H5File-class]{hdf5r::H5File}} object pointing to a \verb{*_Verschaltungen.h5} file,
already opened in read mode.}
}
\value{
A named list with components:

\describe{
\item{n_connections}{\code{integer(1)}. Value of the root dataset
\code{"Anzahl Verschaltungen"} (or \code{NA_integer_} if not present).}

\item{meta}{A tibble with one row per connection:
\code{connection_id}, \code{from_layer}, \code{from_element}, \code{to_layer}, \code{to_element}.}

\item{timeseries}{A tibble with long-format time series for all
connections:
\code{connection_id}, \code{variable}, \code{time}, \code{value},
\code{from_layer}, \code{from_element}, \code{to_layer}, \code{to_element}.}

\item{scalars}{A tibble with all scalar datasets per connection in long
format:
\code{connection_id}, \code{variable}, \code{value} (list), \code{type}.}

\item{connections}{A named list of per-connection sublists:
\code{connections$group_0}, \code{connections$group_1}, ...; each containing
\code{connection_id}, \code{meta}, \code{timeseries}, \code{scalars} für genau diese
Verbindung.}
}
}
\description{
Reads an HDF5 file that contains surface-water \emph{connections} (formerly
"Verschaltungen"), e.g. a file like \code{s78853_Verschaltungen.h5}. The file is
expected to have:
\itemize{
\item a root-level scalar dataset \code{"Anzahl Verschaltungen"}, and
\item one group per connection (\code{"0"}, \code{"1"}, ...) that contains
\itemize{
\item scalar metadata (e.g. \code{von_Layer}, \code{von_Massnahmenelement},
\code{nach_Layer}, \code{nach_Massnahmenelement}) and
\item time-series datasets stored as 2×N matrices
(e.g. \code{Qtatsaechlich}, \verb{delta_h_pond_*}, \verb{delta_theta_*}).
}
}

Scalar metadata are returned
\itemize{
\item als breite Tabelle (\code{meta}),
\item als lange Tabelle (\code{scalars}) und
\item pro Verbindung in einer Unterliste (\code{connections$group_0}, ...).
}

Time series werden in Long-Format zurückgegeben und mit den Metadaten
verknüpft.
}
\examples{
\dontrun{
  library(hdf5r)

  f <- H5File$new(paths$path_verschaltungen_hdf5, mode = "r")
  conn <- read_hdf5_connections(f)

  conn$n_connections
  conn$meta
  conn$timeseries

  # Unterliste für die erste Verbindung:
  conn$connections$group_0$meta
  conn$connections$group_0$timeseries
}

}
